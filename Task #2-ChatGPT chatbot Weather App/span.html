<code class="language-sql"><span class="hljs-keyword">select</span> c.id <span class="hljs-keyword">as</span> customerid, c.name <span class="hljs-keyword">as</span> customername, sum(f.quantityinkg) <span class="hljs-keyword">as</span> totalquantityinkg, sum(f.price) <span class="hljs-keyword">as</span> totalprice <span class="hljs-keyword">from</span> customer <span class="hljs-keyword">as</span> c, fruitorder <span class="hljs-keyword">as</span> f <span class="hljs-keyword">where</span> c.id = f.customerid <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> f.<span class="hljs-function">customerid having <span class="hljs-title">count</span>(<span class="hljs-params">*</span>) &gt;</span>= <span class="hljs-number">3</span> order <span class="hljs-keyword">by</span> c.id;</code>